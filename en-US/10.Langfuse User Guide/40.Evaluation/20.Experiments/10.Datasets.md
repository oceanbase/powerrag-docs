# Datasets

A dataset is a collection of inputs and expected outputs and is used to test your application. Both [UI-based](30.Experiments%20via%20UI.md) and [SDK-based](20.Experiments%20via%20SDK.md) experiments support Langfuse Datasets.

## Why use datasets?

- Create test cases for your application with real production traces
- Collaboratively create and collect dataset items with your team
- Have a single source of truth for your test data

## Get Started

### Creating a dataset

Datasets have a name which is unique within a project.

#### Python SDK

```python
langfuse.create_dataset(
    name="<dataset_name>",
    # optional description
    description="My first dataset",
    # optional metadata
    metadata={
        "author": "Alice",
        "date": "2022-01-01",
        "type": "benchmark"
    }
)
```

#### JS/TS SDK

```ts
import { LangfuseClient } from "@langfuse/client"

const langfuse = new LangfuseClient()

await langfuse.api.datasets.create({
  name: "<dataset_name>",
  // optional description
  description: "My first dataset",
  // optional metadata
  metadata: {
    author: "Alice",
    date: "2022-01-01",
    type: "benchmark",
  },
});
```

#### Langfuse UI

1. In the left-side navigation pane, click **Datasets**. 
2. Click **+ New dataset**.
3. Enter the name, description, and metadata.
4. Click **Create dataset**.

### Upload or create new dataset items

Dataset items can be added to a dataset by providing the input and optionally the expected output. If preferred, dataset items can be imported using the CSV uploader in the Langfuse UI.

#### Python SDK

```python
langfuse.create_dataset_item(
    dataset_name="<dataset_name>",
    # any python object or value, optional
    input={
        "text": "hello world"
    },
    # any python object or value, optional
    expected_output={
        "text": "hello world"
    },
    # metadata, optional
    metadata={
        "model": "llama3",
    }
)
```

#### JS/TS SDK

```ts
import { LangfuseClient } from "@langfuse/client";

const langfuse = new LangfuseClient();

await langfuse.api.datasetItems.create({
  datasetName: "<dataset_name>",
  // any JS object or value
  input: {
    text: "hello world",
  },
  // any JS object or value, optional
  expectedOutput: {
    text: "hello world",
  },
  // metadata, optional
  metadata: {
    model: "llama3",
  },
});
```

#### Langfuse UI

Langfuse offers three ways to upload or create a new dataset item in the UI.

##### Add item

1. On the dataset details page, select the **Items** tab to go to the dataset items list.
2. Click **+ New item**.
3. Select the target datasets. Enter the input, expected output, and metadata of the item.
4. Click **Add to datasets**.

##### Import CSV

1. Prepare a CSV file that includes dataset item inputs, expected outputs, and metadata.
2. On the dataset details page, select the **Items** tab.
3. Click **+ Upload CSV**.
4. Select the CSV file in the pop-up.

##### Add from trace

1. In the left-side navigation pane, click **Tracing**. Click the trace name to expand the details.
2. Click **+ Add to datasets**.
3. Select datasets. You can edit the project's input, expected output, and metadata as needed.
4. Click **Add to datasets**.

## Create items from production data

A common workflow is to select production traces where the application did not perform as expected. Then you let an expert add the expected output to test new versions of your application on the same data.

### Python SDK

```python
langfuse.create_dataset_item(
    dataset_name="<dataset_name>",
    input={ "text": "hello world" },
    expected_output={ "text": "hello world" },
    # link to a trace
    source_trace_id="<trace_id>",
    # optional: link to a specific span, event, or generation
    source_observation_id="<observation_id>"
)
```

### JS/TS SDK

```ts
import { LangfuseClient } from "@langfuse/client";

const langfuse = new LangfuseClient();

await langfuse.api.datasetItems.create({
  datasetName: "<dataset_name>",
  input: { text: "hello world" },
  expectedOutput: { text: "hello world" },
  // link to a trace
  sourceTraceId: "<trace_id>",
  // optional: link to a specific span, event, or generation
  sourceObservationId: "<observation_id>",
});
```

### Langfuse UI

In the UI, add any observation (span, event, generation) of a production trace to datasets.

1. In the left-side navigation pane, click **Tracing**. Click the trace name to expand the details.
2. Click **+ Add to datasets**.
3. Select datasets. You can edit the project's input, expected output, and metadata as needed.
4. Click **Add to datasets**.

## Edit/archive dataset items

You can edit or archive dataset items. Archiving items will remove them from future experiment runs.

### Python SDK

You can upsert items by providing the `id` of the item you want to update.

```python
langfuse.create_dataset_item(
    id="<item_id>",
    # example: update status to "ARCHIVED"
    status="ARCHIVED"
)
```

### JS/TS SDK

You can upsert items by providing the `id` of the item you want to update.

```ts
import { LangfuseClient } from "@langfuse/client";

const langfuse = new LangfuseClient();

await langfuse.api.datasetItems.create({
  id: "<item_id>",
  // example: update status to "ARCHIVED"
  status: "ARCHIVED",
});
```

### Langfuse UI

In the UI, you can edit the item by clicking on the item id. To archive or delete the item, click on the ![](https://obbusiness-private.oss-cn-shanghai.aliyuncs.com/doc/img/powerrag/langfuse/icon7.png) icon next to the item and select **Archive** or **Delete**.

## Dataset runs

Once you created a dataset, you can test and evaluate your application based on it.

+ [Experiments via SDK](20.Experiments%20via%20SDK.md)
+ [Experiments via UI](30.Experiments%20via%20UI.md)
