# 运行环境（Environments）

运行环境（Environment）用于区分和管理来自不同上下文（如生产、预发布、开发等环境）的 Trace、Observation 和 Score 数据。通过运行环境，您可以：

+ 在同一项目中隔离开发环境与生产环境的数据；
+ 按环境过滤并分析观测数据；
+ 在不同环境间复用数据集与提示模板（Prompt）。

## 环境配置
您可以通过以下两种方式配置运行环境：

1. 推荐方式： 设置环境变量 LANGFUSE_TRACING_ENVIRONMENT；
2. 可选方式： 在初始化 PowerRAG 客户端时通过 environment 参数指定。

如果两种方式同时设置，客户端初始化参数的优先级更高。若未设置任何方式，系统将默认使用 default 环境。

## 数据模型
在 PowerRAG 的数据模型中，environment 属性可用于以下所有对象：

+ Traces
+ Observations（包括 span、event、generation 等）
+ Scores
+ Sessions

运行环境名称必须为字符串，并符合以下正则表达式规则：`^(?!langfuse)[a-z0-9-_]+$`，且长度不超过 40 个字符。

命名规则说明：

+ 不能以 “langfuse” 开头；
+ 仅允许使用小写字母、数字、连字符（-）和下划线（_）。

## 使用方法
### Python SDK
```python
from langfuse import get_client, observe
import os

# 设置环境变量（也可在 .env 文件中定义并通过 dotenv 加载）
os.environ["LANGFUSE_TRACING_ENVIRONMENT"] = "production"

# 获取客户端实例（自动使用环境变量）
langfuse = get_client()

# 所有操作将自动归属于 "production" 环境
with langfuse.start_as_current_span(name="my-operation") as span:
    # 编写您的业务逻辑
    pass

@observe
def main():
    return "Hello"

main()
```

### JS/TS SDK
通过命令行设置环境变量：

```bash
export LANGFUSE_TRACING_ENVIRONMENT=production
```

设置完成后，PowerRAG 客户端将自动识别该环境配置。

## 数据过滤（Filtering）
在 PowerRAG 的控制台界面中，您可以通过导航栏中的 Environment 筛选器 按环境过滤事件数据。该筛选条件适用于所有视图，方便您仅查看特定环境的数据。

## 环境管理
系统会在首次接收到指定 environment 值的数据时自动创建对应的环境。已创建的环境将持续存在，目前暂不支持在控制台中删除或重命名环境。

