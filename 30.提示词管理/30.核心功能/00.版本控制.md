# 版本控制

提示词的版本控制和部署通过`versions`和`labels`进行管理。

## 版本和标签
每个提示词版本都会自动分配一个`version ID`。此外，您还可以分配`labels`以遵循您自己的版本控制方案。

标签可用于将提示词分配给环境（暂存、生产）、租户（租户 1、租户 2）或实验（prod-a、prod-b）。

### 使用控制台
通过控制台为提示词分配标签。

1. 在导航栏选择 **提示词**，进入提示词列表。
2. 单击目标提示词，进入提示词详情页面。
3. 在左侧版本列表单击版本后的![](https://obbusiness-private.oss-cn-shanghai.aliyuncs.com/doc/img/powerrag/langfuse/icon1.png)图标，在弹窗中选择 **生产** 标签或自定义标签，或增加自定义标签。
4. 单击 **保存**。

### 使用 Python SDK
创建新提示词版本时，使用 Python SDK 为提示词分配标签。

```plain
langfuse.create_prompt(
    name="movie-critic",
    type="text",
    prompt="As a {{criticlevel}} movie critic, do you like {{movie}}?",
    labels=["production"],  # 向提示词版本添加“production”标签
)
```

或者，您也可以使用 Python SDK 更新现有提示词版本的标签：

```plain
langfuse = Langfuse()
langfuse.update_prompt(
    name="movie-critic",
    version=1,
    new_labels=["john", "doe"], # 向提示词版本添加标签
)
```

### 使用 JS/TS SDK
创建新提示词版本时，使用 JS/TS SDK 为提示词分配标签。

```python
import { LangfuseClient } from "@langfuse/client";
 
const langfuse = new LangfuseClient();
 
await langfuse.prompt.create({
  name: "movie-critic",
  type: "text",
  prompt: "As a {{criticlevel}} critic, do you like {{movie}}?",
  labels: ["production"], // 向提示词版本添加“production”标签
});
```

或者，您也可以使用 JS/TS SDK 更新现有提示词版本的标签：

```python
await langfuse.prompt.update({
  name: "movie-critic",
  version: 1,
  newLabels: ["john", "doe"], //向提示词版本添加标签
});
```

## 按标签或版本获取
在获取提示词信息以在应用中使用时，您可以通过获取特定版本或标签来实现。以下是按标签或版本获取提示词信息的代码示例。

要“部署”提示词版本，您必须将标签`production`或您创建的任何环境标签分配给该提示词版本。

关于获取提示词的一些注意事项：

+ 标签`latest`指向最近创建的版本。
+ 当使用未指定标签的提示词时，Langfuse 将提供带有`production`标签的版本。

### 使用Python SDK
```plain
from langfuse import get_client
 
# 初始化客户端
langfuse = get_client()
 
# 获取特定版本
prompt = langfuse.get_prompt("movie-critic", version=1)
 
# 获取特定标签
prompt = langfuse.get_prompt("movie-critic", label="staging")
 
# 获取最新提示词版本。latest 标签由 Langfuse 自动维护
prompt = langfuse.get_prompt("movie-critic", label="latest")
```

### 使用 JS/TS SDK
```python
import { LangfuseClient } from "@langfuse/client";
 
const langfuse = new LangfuseClient();
 
// 获取特定版本
const prompt = await langfuse.prompt.get("movie-critic", {
  version: 1,
});
 
// 获取特定标签
const prompt = await langfuse.prompt.get("movie-critic", {
  label: "staging",
});
 
// 获取最新提示词版本。latest 标签由 Langfuse 自动维护。
const prompt = await langfuse.prompt.get("movie-critic", {
  label: "latest",
});
```

## 回滚
当提示词带有`production`标签时，SDK 中将默认提供该版本。您可以通过`production`在 Langfuse 界面中将标签设置为之前的版本来快速回滚到之前的版本。

## 提示词差异
提示词版本差异视图会显示您在一段时间内对提示词所做的更改。这有助于您了解提示词的演变过程以及所做的更改，以便调试问题或了解更改的影响。

1. 在导航栏选择 **提示词**，进入提示词列表。
2. 单击目标提示词，进入提示词详情页面。
3. 在页面左侧的版本列表单击要对比的修改后的版本，页面右侧将出现提示词内容。
4. 鼠标移动到要对比的修改前的版本，版本右下角将出现![](https://obbusiness-private.oss-cn-shanghai.aliyuncs.com/doc/img/powerrag/langfuse/icon2.png)图标。单击该图标，将出现弹窗，弹窗中展示两个版本的差异。



  
 

