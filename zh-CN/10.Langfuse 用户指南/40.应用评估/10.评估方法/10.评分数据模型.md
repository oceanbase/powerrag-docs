# 评分数据模型

Langfuse 中，评分是用于存储评估的数据对象。它是一个灵活的对象，可用于所有评估方法，将评估评分赋分给 Langfuse 平台上的不同对象。从抽象的角度来看，您可以将评分视为评估方法的输出。

## 评分
`Scores`（评分）作为 Langfuse 中存储评估指标的对象。其核心属性如下：

+ 评分引用 `Trace`、`Observation`、`Session`或`DatasetRun`。
+ 每个评分都恰好引用上述对象之一。
+ 评分可以是数字、分类或布尔值。
+ 评分可以选择性地链接到`ScoreConfig`以确保它们符合特定的模式。

![](https://obbusiness-private.oss-cn-shanghai.aliyuncs.com/doc/img/powerrag/langfuse/score-model1.png)

### 常见用途
| **层级** | **描述** |
| --- | --- |
| `Trace` | 用于评估单个交互。（最常见） |
| `Observation` | 用于评估低于`Trace`层级的单个观测。 |
| `Session` | 用于对多个交互的输出进行综合评估。 |
| `DatasetRun` | 用于数据集运行的性能评分。详情请参见 [跑测数据模型](../20.跑测/40.跑测数据模型.md)。 |


### Scores 对象
| **属性** | **类型** | **描述** |
| --- | --- | --- |
| `name` | string | 评分的名称，例如 user_feedback、hallucination_eval。 |
| `value` | number | 可选：评分的数值。数值型和布尔型评分必须定义。分类型评分为可选。 |
| `stringValue` | string | 可选：布尔型和分类型评分数值的字符串等效值。若提供，则根据配置自动设置分类评分`configId`。 |
| `traceId` | string | 可选：与评分相关的跟踪的 ID |
| `observationId` | string | 可选：与评分相关的观测（例如 LLM 调用） |
| `sessionId` | string | 可选：与评分相关的会话的 ID。 |
| `datasetRunId` | string | 可选：与评分相关的数据集跑测的 ID。 |
| `comment` | string | 可选：评估注释，常用于用户反馈、评估推理输出或内部注释。 |
| `id` | string | 评分的唯一标识符。由 SDK 自动生成。也可用作更新评分的幂等 key。 |
| `source` | string | 根据评分来源自动设置。可以是`API`、`EVAL`或`ANNOTATION`。 |
| `dataType` | string | 当提供了`configId`时，根据配置数据类型自动设置。否则，可以手动定义为`NUMERIC`，`CATEGORICAL`或`BOOLEAN`。 |
| `configId` | string | 可选：评分配置 ID，用于确保评分遵循特定架构。可以在 Langfuse 控制台或通过 API 定义。提供后，评分`dataType`将根据配置自动设置。 |


## 评分配置
评分配置（Score Config）用于确保您的评分遵循特定的模式。使用评分配置可以让您在整个团队中标准化评分模式，并确保评分的一致性和可比性，以便日后进行分析。

您可以在 Langfuse 控制台或通过 API 定义`scoreConfig`。配置是不可改的，但可以存档（并可随时恢复）。

![](https://obbusiness-private.oss-cn-shanghai.aliyuncs.com/doc/img/powerrag/langfuse/score-model2.png)

评分配置包括：

+ 评分名称
+ 数据类型：`NUMERIC`、`CATEGORICAL`或`BOOLEAN`
+ 评分值范围的限制（数值的最小值/最大值，分类数据类型的自定义类别）

### ScoreConfig 对象
| **属性** | **类型** | **描述** |
| --- | --- | --- |
| `id` | string | 评分配置的唯一标识符。 |
| `name` | string | 评分配置的名称，例如 user_feedback、hallucination_eval。 |
| `dataType` | string | 可以是`NUMERIC`，`CATEGORICAL`或者`BOOLEAN`。 |
| `isArchived` | boolean | 评分配置是否存档。默认为 false。 |
| `minValue` | number | 可选：设置数值评分的最小值。如果未设置，则最小值默认为 -∞。 |
| `maxValue` | number | 可选：设置数值评分的最大值。如果未设置，则最大值默认为 +∞。 |
| `categories` | list | 可选：定义分类型评分的类别。带有标签值对的对象列表。 |
| `description` | string | 可选：提供评分配置的进一步描述。 |


