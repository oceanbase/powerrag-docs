# Message Placeholders

Message Placeholders allow you to insert a list of chat messages (`[{role: "...", content: "..."}]`) at specific positions within a chat prompt.

You can define multiple placeholders in a prompt and resolve them with different values at runtime.
Message Placeholders are also supported in the [Playground](30.Playground.md) and [Prompt Experiments](../../40.Evaluation/20.Experiments/30.Experiments%20via%20UI.md).

## Create prompt with placeholders

### Langfuse UI

1. Enter the prompt edit page.
    - Create a prompt: In the left-side navigation pane, click **Prompts**. Click **+ New prompt** in the upper-right corner of the page.
    - Update a prompt: In the left-side navigation pane, click **Prompts**. Click the prompt name and **+ New**.
2. Select **Chat** as the prompt type.
3. Click **+ Placeholder**.
2. Enter a name, such as `chat_history`, for the placeholder that will be used to reference it in your application.

### Python SDK

```python
from langfuse import get_client

langfuse = get_client()

langfuse.create_prompt(
    name="movie-critic-chat",
    type="chat",
    prompt=[
      { "role": "system", "content": "You are an {{criticlevel}} movie critic" },
      { "type": "placeholder", "name": "chat_history" },
      { "role": "user", "content": "What should I watch next?" },
    ],
    labels=["production"],  # directly promote to production
)
```

### JS/TS SDK

```typescript
import { LangfuseClient } from "@langfuse/client";

const langfuse = new LangfuseClient();

await langfuse.prompt.create({
  name: "movie-critic-chat",
  type: "chat",
  prompt: [
    { role: "system", content: "You are an {{criticlevel}} movie critic" },
    { type: "placeholder", name: "chat_history" },
    { role: "user", content: "What should I watch next?" },
  ],
  labels: ["production"], // directly promote to production
});
```

## Resolve placeholders at runtime

In the SDKs, use the `.compile(variables, placeholders)` method on a `ChatPromptClient` to set the values to be filled in for the placeholders.
The filled in messages should be of the `ChatMessage` format with a `role` and `content` property, but custom formats are also accepted as `compile` does not validate the format of the messages.

### Python SDK

```python
from langfuse import get_client

langfuse = get_client()

# Use prompt with placeholders in your application
prompt = langfuse.get_prompt("movie-critic-chat")

# Compile the variable and resolve the placeholder with a list of messages.
compiled_prompt = prompt.compile(criticlevel="expert", chat_history=[
  {"role": "user", "content": "I love Ron Fricke movies like Baraka"},
  {"role": "user", "content": "Also, the Korean movie Memories of a Murderer"}
])

# -> compiled_prompt = [
#   { "role": "system", "content": "You are an expert movie critic" },
#   { "role": "user", "content": "I love Ron Fricke movies like Baraka" },
#   { "role": "user", "content": "Also, the Korean movie Memories of a Murderer" },
#   { "role": "user", "content": "What should I watch next?" },
# ]
```

### JS/TS SDK

```typescript
import { LangfuseClient } from "@langfuse/client";

const langfuse = new LangfuseClient();

const prompt = await langfuse.prompt.get("movie-critic-chat", {
  type: "chat",
});

// Compile the variable and resolve the placeholder with a list of messages.
const compiledPrompt = prompt.compile(
  // variables
  { criticlevel: "expert" },
  // placeholders
  {
    chat_history: [
      { role: "user", content: "I love Ron Fricke movies like Baraka" },
      {
        role: "user",
        content: "Also, the Korean movie Memories of a Murderer",
      },
    ],
  }
);

// -> compiledPrompt = [
//   { role: "system", content: "You are an expert movie critic" },
//   { role: "user", content: "I love Ron Fricke movies like Baraka" },
//   { role: "user", content: "Also, the Korean movie Memories of a Murderer" },
//   { role: "user", content: "What should I watch next?" },
// ]
```
