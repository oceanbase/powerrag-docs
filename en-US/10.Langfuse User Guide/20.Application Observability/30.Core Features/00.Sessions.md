# Sessions

In most LLM applications, a complete interaction often involves multiple traces. The Session feature in PowerRAG is used to group these traces together and provide visual Session Replay for that interaction. To use this feature, simply add a `sessionId` parameter when creating a trace. All traces using the same `sessionId` are automatically grouped into the same session.

## How to use

### Python SDK

+ Using the @observe() decorator

```python
from langfuse import observe, get_client

@observe()
def process_request():
    # Get client instance
    langfuse = get_client()

    # Add session_id to current trace
    langfuse.update_current_trace(session_id="your-session-id")

    # ... processing logic ...
    return result
```

+ Directly creating a span

```python
from langfuse import get_client

langfuse = get_client()

# Set session_id when creating root span
with langfuse.start_as_current_span(
    name="process-chat-message"
) as root_span:
    # Add session_id to trace
    root_span.update_trace(session_id="chat-session-123")

    # All spans under this trace belong to the same session
    with root_span.start_as_current_generation(
        name="generate-response",
        model="gpt-4o"
    ) as gen:
        # ... generate response ...
        pass
```

+ Updating session without direct span reference

```python
with langfuse.start_as_current_span(name="another-operation"):
    # Add session_id to current trace
    langfuse.update_current_trace(session_id="your-session-id")
```

### JS/TS SDK

+ Using context managers

```typescript
import {
  startActiveObservation,
  startObservation,
  updateActiveTrace,
} from "@langfuse/tracing";

await startActiveObservation("context-manager", async (span) => {
  span.update({
    input: { query: "What is the capital of France?" },
  });

  // Set sessionId for trace
  updateActiveTrace({
    sessionId: "session-123",
  });
});
```

+ Using observe wrapper function

```typescript
import { observe, updateActiveTrace } from "@langfuse/tracing";

// Original function
async function fetchData(source: string) {
  // Set sessionId for trace
  updateActiveTrace({
    sessionId: "session-123",
  });

  // ... data fetching logic ...
  return { data: `some data from ${source}` };
}

// Use observe for tracing
const tracedFetchData = observe(fetchData, {
  name: "observe-wrapper",
});

const result = await tracedFetchData("API");
```

+ Manually creating a span

```typescript
import { startObservation } from "@langfuse/tracing";

const span = startObservation("manual-observation", {
  input: { query: "What is the capital of France?" },
});

// Set sessionId for trace
span.updateTrace({
  sessionId: "session-123",
});

span.update({ output: "Paris" }).end();
```

