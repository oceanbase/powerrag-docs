# 跑测数据模型

## Langfuse 数据集模型
本节介绍在 Langfuse 数据集上进行实验的数据模型。

### 数据集
数据集是输入和可选的预期输出的集合，可在数据集跑测期间使用。

`Dataset`（数据集）是`DatasetItem`（数据集项目）的集合。

![](https://obbusiness-private.oss-cn-shanghai.aliyuncs.com/doc/img/powerrag/langfuse/run-model1.png)

#### Dataset 对象
| **属性** | **类型** | **必填** | **描述** |
| --- | --- | --- | --- |
| `id` | string | 是 | 数据集的唯一标识符 |
| `name` | string | 是 | 数据集名称 |
| `description` | string | 否 | 数据集描述 |
| `metadata` | object | 否 | 数据集的附加元数据 |
| `remoteExperimentUrl` | string | 否 | 用于触发实验的 Webhook 端点 |
| `remoteExperimentPayload` | object | 否 | 触发跑测的有效负载 |


#### DatasetItem 对象
| **属性** | **类型** | **必填** | **描述** |
| --- | --- | --- | --- |
| `id` | string | 是 | 数据集项目的唯一标识符。数据集项目根据其 ID 进行更新插入。ID 必须是唯一的（项目级别），并且不能跨数据集重复使用。 |
| `datasetId` | string | 是 | 该项目所属数据集的 ID |
| `input` | object | 否 | 数据集项目的输入数据 |
| `expectedOutput` | object | 否 | 数据集项目的预期输出数据 |
| `metadata` | object | 否 | 数据集项目的附加元数据 |
| `sourceTraceId` | string | 否 | 此数据集项目链接到的源跟踪的 ID |
| `sourceObservationId` | string | 否 | 此数据集项目链接到的源观测的 ID |
| `status` | DatasetStatus | 否 | 数据集项目的状态。新创建项目默认为`ACTIVE`。可能的值为`ACTIVE`、`ARCHIVED`。 |


### 数据集跑测
`Dataset Run`（数据集跑测）用于通过 LLM 应用程序跑测数据集，并可选择将评估方法应用于结果。

![](https://obbusiness-private.oss-cn-shanghai.aliyuncs.com/doc/img/powerrag/langfuse/run-model2.png)

#### DatasetRun 对象
| **属性** | **类型** | **必填** | **描述** |
| --- | --- | --- | --- |
| `id` | string | 是 | 数据集跑测的唯一标识符 |
| `name` | string | 是 | 数据集跑测的名称 |
| `description` | string | 否 | 数据集跑测的描述 |
| `metadata` | object | 否 | 数据集跑测的附加元数据 |
| `datasetId` | string | 是 | 本次跑测所属数据集的 ID |


#### DatasetRunItem 对象
| **属性** | **类型** | **必填** | **描述** |
| --- | --- | --- | --- |
| `id` | string | 是 | 数据集跑测项目的唯一标识符 |
| `datasetRunId` | string | 是 | 该项目所属的数据集跑测的 ID |
| `datasetItemId` | string | 是 | 链接到本次跑测的数据集项目的 ID |
| `traceId` | string | 是 | 链接到本次跑测的跟踪的 ID |
| `observationId` | string | 否 | 链接到本次跑测的观察的 ID |

<main id="notice" type='explain'>
    <h4>说明</h4>
    <p>大多数情况下，我们建议 DatasetRunItems 直接引用 TraceID。引用 ObservationID 仅为向后兼容旧版 SDK。</p>
</main>

### 端到端数据关系
`DatasetRun` 可以组合一些 Langfuse 对象：

+ `DatasetRun` 是通过使用 LLM 应用循环遍历运行数据集中所有的或选定的`DatasetItem`来创建的。
+ 对于传递到 LLM 应用中的每个`DatasetItem`输入，都会创建一个`DatasetRunItem`和一个`Trace`。
+ 可选地，`Score`将被添加到`Trace`中以评估 LLM 应用在数据集跑测期间的输出。

![](https://obbusiness-private.oss-cn-shanghai.aliyuncs.com/doc/img/powerrag/langfuse/run-model3.png)

## 本地数据集模型
目前，如果[通过 SDK 跑测](20.通过%20SDK%20跑测.md)并在本地数据集上跑测，则 Langfuse 中只会创建跟踪，不会生成任何数据集跑测。每次跑测都会创建单独的跟踪，以便于观测和调试。

